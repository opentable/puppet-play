#
# Upstart script for <%= @name %>
#
description     "Start and Stop the <%= @name %> application"
author          "Clement Escoffier <clement.escoffier@gmail.com>"
version         "1.0"

env PROJ_HOME=<%= @path %>
env PID=<%= @path %>/RUNNING_PID

env PLAY_BINARY=<%= @path %>/target/universal/stage/bin/<%= @projectName %>

env USER=<%= @user %>
env GROUP=<%= @group %>

start on (filesystem and net-device-up IFACE=lo) or runlevel [2345]
stop on runlevel [!2345]

respawn
respawn limit 100 60
umask 022
expect daemon


script
echo "1. "
cd ${PROJ_HOME}
echo "2. "
exec start-stop-daemon --pidfile <%= @path %>/RUNNING_PID --chdir <%= @path %> --chuid $USER:$GROUP --exec <%= @path %>/target/universal/stage/bin/<%= @projectName %> --background --start -- <%= @javaOptions %>
echo "3. "
end script
